dat=read.csv("https://raw.githubusercontent.com/AndrewGutierrez/drugdeaths/master/Accidental_Drug_Related_Deaths__2012-2017.csv")
dat$CaseNumber=NULL
dat$AmendedMannerofDeath=NULL
dat$MannerofDeath=NULL
dat$DescriptionofInjury=NULL
nrow(dat)-sum(complete.cases(dat))
summary(dat)
avg_age=round(mean(dat[!is.na(dat$Age),]$Age))
dat[is.na(dat$Age),]$Age =avg_age
#not sure why running this code twice gives an error
dat$Race=ifelse(dat$Race=="", "Unknown", levels(dat$Race)[dat$Race])
dat$Sex=ifelse(dat$Sex=="", sample(c("Male", "Female"), 1, replace=TRUE), levels(dat$Sex)[dat$Sex])
dat$Location=ifelse(dat$Location!="Residence" & dat$Location!="Hospital", "Other", levels(dat$Location)[dat$Location])
dat$InjuryPlace=ifelse(dat$InjuryPlace=="", "Unknown", levels(dat$InjuryPlace)[dat$InjuryPlace])
hospital_death=ifelse(dat$Location=="Hospital", "Yes", "No")
dat$hospital=hospital_death
Residence_death=ifelse(dat$Location=="Residence", "Yes", "No")
dat$Residence=Residence_death
heroin=ifelse(dat$Heroin=="Y" | dat$Heroin=="y", "Y", "N")
dat$Heroin=heroin
cocaine=ifelse(dat$Cocaine=="Y" | dat$Cocaine=="y", "Y", "N")
dat$Cocaine=cocaine
Oxycodone=ifelse(dat$Oxycodone=="Y" | dat$Oxycodone=="y", "Y", "N")
dat$Oxycodone=Oxycodone
Oxymorphone=ifelse(dat$Oxymorphone=="Y" | dat$Oxymorphone=="y", "Y", "N")
dat$Oxymorphone=Oxymorphone
EtOH=ifelse(dat$EtOH=="Y" | dat$EtOH=="y", "Y", "N")
dat$EtOH=EtOH
Hydrocodone=ifelse(dat$Hydrocodone=="Y" | dat$Hydrocodone=="y", "Y", "N")
dat$Hydrocodone=Hydrocodone
Amphet=ifelse(dat$Amphet=="Y" | dat$Amphet=="y", "Y", "N")
dat$Amphet=Amphet
Methadone=ifelse(dat$Methadone=="Y" | dat$Methadone=="y", "Y", "N")
dat$Methadone=Methadone
Tramad=ifelse(dat$Tramad=="Y" | dat$Tramad=="y", "Y", "N")
dat$Tramad=Tramad
Benzodiazepine=ifelse(dat$Benzodiazepine=="Y" | dat$Benzodiazepine=="y" | dat$Benzodiazepine==" Y", "Y", "N")
dat$Benzodiazepine=Benzodiazepine
Fentanyl=ifelse(dat$Fentanyl=="", "N", "Y")
dat$Fentanyl=Fentanyl
View(dat)
plot(density(dat$Age))
plot(density(dat$age), main="Density of age in the data set", col="cadetblue4")
plot(density(dat$Age), main="Density of age in the data set", col="cadetblue4")
plot(density(dat$Age), main="Density of age in the data set", col="cadetblue")
plot(density(dat$Age), main="Density of age in the data set", col="cadetblue3")
plot(density(dat$Age), main="Density of age in the data set", col="cadetblue")
mean(dat$Age)
str(dat$Date)
dat$Date=as.character(dat$Date)
str(dat$Date)
substr(dat$Date, 1, nchar(dat$Date))
substr(dat$Date, 6, nchar(dat$Date))
substr(dat$Date, 7, nchar(dat$Date))
years=substr(dat$Date, 7, nchar(dat$Date))
table(years)
sum(dat$Date=="")
dat[dat$Date=="",]
years=substr(dat$Date, 7, nchar(dat$Date))
barplot(table(years))
years=substr(dat$Date, 7, nchar(dat$Date))
barplot(table(years), main="Number of deaths per year", col="coral")
dat$years=substr(dat$Date, 7, nchar(dat$Date))
barplot(table(years), main="Number of deaths per year", col="coral")
dat$years=substr(dat$Date, 7, nchar(dat$Date))
barplot(table(dat$years), main="Number of deaths per year", col="coral")
table(dat$Race)
barplot(table(dat$Race), main="Number of deaths per race", col="coral")
barplot(table(dat$Race), main="Number of deaths per race", col="coral", las=1, horiz=TRUE)
par(mar=c(3,10,3,3))
barplot(table(dat$Race), main="Number of deaths per race", col="coral", las=1, horiz=TRUE)
par(mar=c(3,10,3,3))
barplot(sort(table(dat$Race)), main="Number of deaths per race", col="coral", las=1, horiz=TRUE)
barplot(table(dat$Sex), main="Deaths per sex", col="coral")
barplot(table(dat$Sex), main="Deaths per sex", col="coral", ylim=3000)
barplot(table(dat$Sex), main="Deaths per sex", col="coral", ylim=c(0,3000))
table(dat$InjuryPlace)
table(dat$Location)
table(dat$InjuryPlace)
sum(dat$Heroin=="Y")
sum(dat$Cocaine=="Y")
sapply(dat[, 13:24], sum)
sapply(dat[, 13:24], table)
sapply(dat[, 14:24], table)
type_of_drug=data.frame(sapply(dat[, 14:24], table))
View(type_of_drug)
barplot(sapply(dat[, 14:24], table))
barplot(sapply(dat[, 14:24]=="Y", table))
tbl=sapply(dat[, 14:24], table)
barplot(tbl[,2])
tbl=sapply(dat[, 14:24], table)
barplot(tbl[2,])
tbl=sapply(dat[, 14:24], table)
barplot(tbl[2,], main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral")
tbl=sapply(dat[, 14:24], table)
par(mar=c(3,10,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral")
tbl=sapply(dat[, 14:24], table)
par(mar=c(3,8,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral")
tbl=sapply(dat[, 14:24], table)
par(mar=c(3,8,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral", xlim=c(0, 2400))
tbl=sapply(dat[, 14:24], table)
par(mar=c(3,8,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral", xlim=c(0, 2500))
par(mar=c(3,8,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral", xlim=c(0, 2500))
tbl=sapply(dat[, 14:24], table)
par(mar=c(3,8,3,3))
barplot(sort(tbl[2,]), main="Number of recorded uses per drug type", las=1, horiz=TRUE, col="coral", xlim=c(0, 2500))
plot(density(dat$Age), main="Density of age in the data set", col="cadetblue")
grid()
fit=glm(Location ~ Sex + Race, data=dat, family = binomial)
fit=glm(Location ~ Sex + Race, data=dat)
fit=glm(Location ~ Age, data=dat)
fit=glm(years ~ Age, data=dat)
day$years=as.numeric(dat$years)
dat$years=as.numeric(dat$years)
fit=glm(years ~ Age, data=dat)
probs = predict(fit, newdata=dat, type="response")
library(rpart)
library(rpart.plot)
dat$years=as.numeric(dat$years)
fit=glm(years ~ Age, data=dat)
probs = predict(fit, newdata=dat, type="response")
predict()
predict
probs
probs = predict(fit, newdata=dat, type="response")
probs=round(probs)
probs
table(probs)
